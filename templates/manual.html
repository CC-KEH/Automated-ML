<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ML Model Configuration</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            margin: 0;
            padding: 0;
            height: 100vh;
        }

        h2 {
            font-size: 40px;
            margin: 0 0 10px 0;
            font-family:'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin-bottom: 20px;
        }

        p {
            font-size: 18px;
            margin: 0 0 12px 0;
        }

        .container {
            display: flex;
            width: 100%;
        }
        .left-panel, .right-panel {
            padding: 20px;
            box-sizing: border-box;
        }
        .left-panel {
            width: 40%;
            max-width: 40%;
            background-color: #f0f0f0;
        }
        .right-panel {
            width: 50%;
            padding-left: 30px;
        }
        h2 {
            margin-top: 0;
        }
        select {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
        }
        input{
            width: 100%;
            padding: 10px;
            margin: 10px 0;
        }
        #algorithm{
            display: block;
            width: 53%;
        }

        .parameter-group {
            margin-top: 20px;
            width: 50%;
        }

        .button-group {
            margin-top: 30px;
        }
        button{
            padding: 10px;
            background-color: transparent;
            color: black;
            cursor: pointer;
            border-radius: 4px;
            height: 40px;
            width: 150px;
            border-width: 1px;
            margin: 10px;
            margin-left: 0px;
        }
        button:hover{
            background-color: #6f7399;
            color: #fff;
        }
        button:focus{
            background-color: #6f7399;
            color: #fff;
        }
        switch > input[type="checkbox"] {
            accent-color: #6f7399;
            cursor: pointer;
        }
    </style>
</head>
<body>

<div class="container">
    <!-- Left panel: Selected Algorithm Info -->
    <div class="left-panel">
        <h2>Selected Algorithm</h2>
        <p><strong>Algorithm Name:</strong> <span id="algorithm-name">N/A</span></p>
        <p><strong>Task Type:</strong> <span id="task-type">N/A</span></p>
        <p><strong>Description:</strong> <span id="algorithm-description">Please select an algorithm from the right.</span></p>
        <p><strong>Other Info:</strong> Depending on the selected model, additional information can be shown here.</p>
    </div>

    <!-- Right panel: Model configuration -->
    <div class="right-panel">
        <h2>Configure Your Model</h2>

        <!-- Algorithm Dropdown -->
        <label for="algorithm">Algorithm:</label>
        <select id="algorithm" onchange="updateHyperparameters()">
        </select>

        <!-- Hyperparameters Section -->
        <div class="parameter-group" id="hyperparameter-fields">
        </div>

        <!-- Button Group -->
        <div class="button-group">
            <button onclick="submitConfig()">Train</button>
        </div>
    </div>
</div>

<script>
// Predefined algorithms for regression and classification
const regressionModels = {
    'Linear Regression': {
        description: 'Linear Regression is used to predict continuous values.',
        hyperparameters: {
            'fit_intercept': 'checkbox',
            'normalize': 'checkbox',
            'copy_X': 'checkbox'
        }
    },
    'Elastic Net Regressor': {
        description: 'Elastic Net is a linear regression model trained with L1 and L2 prior as regularizer.',
        hyperparameters: {
            'alpha': 'number',
            'l1_ratio': 'number',
            'max_iter': 'number',
            'selection': 'text' // 'cyclic' or 'random'
        }
    },
    'Decision Tree Regressor': {
        description: 'Decision Tree is a flowchart-like tree structure where an internal node represents a feature.',
        hyperparameters: {
            'criterion': 'text', // 'squared_error' , “friedman_mse”, “absolute_error”, “poisson”
            'splitter': 'text', // 'best' or 'random'
            'max_depth': 'number',
            'min_samples_split': 'number',
            'min_samples_leaf': 'number',
            'max_features': 'text' // 'auto', 'sqrt', 'log2'
        }
    },
    'Random Forest Regressor': {
        description: 'Random Forest is a versatile regression algorithm.',
        hyperparameters: {
            'n_estimators': 'number',
            'criterion': 'text', // 'squared_error' , “friedman_mse”, “absolute_error”, “poisson”
            'max_depth': 'number',
            'random_state': 'number',
            'max_features': 'text' // 'auto', 'sqrt', 'log2'
        },
        
    },
    'Support Vector Machine Regressor': {
        description: 'Support Vector Machine is used for both regression and classification tasks.',
        hyperparameters: {
            'kernel': 'text', // 'linear', 'poly', 'rbf', 'sigmoid'
            'C': 'number',
            'gamma': 'number'
        }
    }
};

const classificationModels = {
    'Logistic Regression': {
        description: 'Logistic Regression is used for binary or multi-class classification.',
        hyperparameters: {
            'C': 'number',
            'penalty': 'text',
            'solver': 'text'
        }
    },
    'Gaussion Naive Bayes Classifier': {
        description: 'Gaussian Naive Bayes is a simple probabilistic classifier based on applying Bayes theorem.',
        hyperparameters: {
            'var_smoothing': 'number'
        }
    },
    'Random Forest Classifier': {
        description: 'Random Forest is a versatile classification algorithm.',
        hyperparameters: {
            'n_estimators': 'number',
            'max_depth': 'number',
            'random_state': 'number'
        }
    },
    'K-Nearest Neighbors Classifier': {
        description: 'K-Nearest Neighbors is a simple algorithm that stores all available cases and classifies new cases based on a similarity measure.',
        hyperparameters: {
            'n_neighbors': 'number',
            'weights': 'text',
            'algorithm': 'text'
        }
    },
    'Decision Tree Classifier': {
        description: 'Decision Tree is a flowchart-like tree structure where an internal node represents a feature.',
        hyperparameters: {
            'max_depth': 'number',
            'min_samples_split': 'number',
            'min_samples_leaf': 'number'
        }
    },
    'Support Vector Machine Classifier': {
        description: 'Support Vector Machine is used for both regression and classification tasks.',
        hyperparameters: {
            'kernel': 'text',
            'C': 'number',
            'gamma': 'number'
        }
    }
};

// Assume taskType is known from the backend (either 'regression' or 'classification')
let taskType = 'regression'; // or 'classification', set this dynamically based on task

// Load appropriate models on page load
window.onload = function() {
    populateAlgorithmOptions();
};

function populateAlgorithmOptions() {
    const algorithmSelect = document.getElementById('algorithm');
    algorithmSelect.innerHTML = ''; // Clear existing options

    const models = taskType === 'regression' ? regressionModels : classificationModels;
    for (let model in models) {
        const option = document.createElement('option');
        option.value = model;
        option.text = model;
        algorithmSelect.add(option);
    }

    updateHyperparameters(); // Show initial hyperparameters
}

function updateHyperparameters() {
    const selectedAlgorithm = document.getElementById('algorithm').value;
    const models = taskType === 'regression' ? regressionModels : classificationModels;

    // Update selected algorithm info on the left panel
    document.getElementById('algorithm-name').innerText = selectedAlgorithm;
    document.getElementById('task-type').innerText = taskType;
    document.getElementById('algorithm-description').innerText = models[selectedAlgorithm].description;

    // Generate hyperparameter fields
    const hyperparameterFields = document.getElementById('hyperparameter-fields');
    hyperparameterFields.innerHTML = ''; // Clear previous fields

    const hyperparameters = models[selectedAlgorithm].hyperparameters;
    for (let param in hyperparameters) {
        const inputType = hyperparameters[param];
        const label = document.createElement('label');
        label.innerText = param;

        const input = document.createElement('input');
        input.type = inputType;
        input.id = param;

        hyperparameterFields.appendChild(label);
        hyperparameterFields.appendChild(input);
    }
}

function submitConfig() {
    const selectedAlgorithm = document.getElementById('algorithm').value;

    // Collect hyperparameter values
    const hyperparameters = {};
    document.querySelectorAll('#hyperparameter-fields input').forEach(input => {
        if (input.type === 'checkbox') {
            hyperparameters[input.id] = input.checked;
        } else {
            hyperparameters[input.id] = input.value;
        }
    });

    // Prepare data to send to Flask
    const data = {
        algorithm: selectedAlgorithm,
        hyperparameters: hyperparameters
    };

    // Send POST request to Flask
    fetch('/manual_train', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify(data)
    })
    .then(response => response.json())
    .then(result => {
        console.log('Training Result:', result);
        alert('Model training started: ' + result.message);
    })
    .catch(error => {
        console.error('Error:', error);
    });
}
</script>
</body>
</html>